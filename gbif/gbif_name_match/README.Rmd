---
title: "GBIF API species annotations"
author: "Stijn Van Hoey"
date: "September 18, 2017"
output:
  md_document:
    variant: markdown_github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("./gbif_species_name_match.R")
```

## Introduction

Working with different partners/institutes/researchers results in a diversity of taxonomic names to define species. This hardens comparison amongst datasets, as in many occasions, aggregation is aimed for or filtering on specific species. By translating all species names to a common taxonomic backbone (ensuring unique ID's for each species name), this can be done. This function supports matching with the GBIF taxonomic backbone.

## Aim

This small utility provides the functionality to add the species information from the GBIF backbone to any data table (`data.frame`) by requesting this information via the GBIF API. For each match, the corresponding accepted name is looked for. Nevertheless there will always be errors and control is still essential!

## Functionality

The `request_species_information` function extends the matching function provided by [Rgbif](https://github.com/ropensci/rgbif) to be compatible with a `data.frame` data structure.

Consider the example file `example_species`:

```{r read_data}
my_data <- read.csv("../data/example_species.csv")
knitr::kable(my_data)
```

To add the species information, using the `scientificName` column, and the default fields:

```{r func_app, message=FALSE, warning=FALSE}

my_data_update <- request_species_information(my_data)
knitr::kable(my_data_update)
```

When not satisfied by the default fields provided (`usageKey`, `scientificName`, `rank`, `status`, `family`), you can alter these by the `gbif_terms` argument, for example:

```{r gbif_terms,message=FALSE, warning=FALSE}
gbif_terms_to_use <- c('scientificName', 'order')
my_data_update <- request_species_information(my_data, gbif_terms = gbif_terms_to_use)
knitr::kable(my_data_update)
```
